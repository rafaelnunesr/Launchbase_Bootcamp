{% extends '../layout.njk' %}

{% block head %}
    <title>Foodfy | Edição Receita</title>
{% endblock %}

{% block content %}
    <div class="main-page">
        <div class="admin-subheader">
            <div class="admin-page-title">
                <h1>Editando: {{recipe.name}}</h1>
            </div>
        </div>

        <form method="POST" action="/admin/recipes?_method=PUT" enctype="multipart/form-data" id="form">
            <button class="delete-button" type="submit">Deletar</button>
            <button class="save-button" type="submit">Salvar Receita</button>
            <input type="hidden" name='id' value={{recipe.id}}>
            {% include "./fields.njk" %}
        </form>
    </div>

    <script>
        const formDelete = document.querySelector('#form')
        const deleteButton = document.querySelector('.delete-button')
        deleteButton.addEventListener('click', function(event){
            const confirmation = confirm('Deseja Deletar?') // global confirmacao que retorna um boolean
            if (!confirmation){
                event.preventDefault() // cancela o submit
            }else {
                formDelete.action = '/admin/recipes?_method=DELETE'
                formDelete.enctype=''
                formDelete.submit()
            }

        })
    </script>

{% endblock %}